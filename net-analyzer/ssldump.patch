diff -Naurp ssldump.old/files/ssldump-0.9-makefile-fix.patch ssldump/files/ssldump-0.9-makefile-fix.patch
--- ssldump.old/files/ssldump-0.9-makefile-fix.patch	1970-01-01 09:00:00.000000000 +0900
+++ ssldump/files/ssldump-0.9-makefile-fix.patch	2012-05-04 17:20:08.945629498 +0900
@@ -0,0 +1,21 @@
+eliminates unused variable ROOT, which disturbs ld from Prefix. Bug #414335
+--- Makefile.in	2001-11-27 07:38:13.000000000 +0900
++++ Makefile.in.new	2012-05-02 16:13:10.000000000 +0900
+@@ -46,13 +46,12 @@ BINDIR=@sbindir@
+ MANDIR=@mandir@
+ RM=rm -f
+ 
+-ROOT=./
+-ANALYZE_SRCDIR=$(ROOT)base/
++ANALYZE_SRCDIR=base/
+ COMMONDIR=common/
+ COMMON_LIB_SRCDIR=$(COMMONDIR)lib/
+-ANALYZE_NULL_SRCDIR=$(ROOT)null/
+-ANALYZE_SSL_SRCDIR=$(ROOT)ssl/
+-ANALYZE_RECORD_SRCDIR=$(ROOT)@RECORD_MOD@/
++ANALYZE_NULL_SRCDIR=null/
++ANALYZE_SSL_SRCDIR=ssl/
++ANALYZE_RECORD_SRCDIR=@RECORD_MOD@/
+ include rules.mk
+ 
+ include $(COMMON_LIB_SRCDIR)/targets.mk
diff -Naurp ssldump.old/ssldump-0.9-r1.ebuild ssldump/ssldump-0.9-r1.ebuild
--- ssldump.old/ssldump-0.9-r1.ebuild	2011-12-10 01:15:55.000000000 +0900
+++ ssldump/ssldump-0.9-r1.ebuild	2012-05-04 17:24:03.220640642 +0900
@@ -13,7 +13,7 @@ SRC_URI="http://www.rtfm.com/ssldump/${M
 
 LICENSE="openssl"
 SLOT="0"
-KEYWORDS="amd64 ppc sparc x86"
+KEYWORDS="amd64 ~arm ppc sparc x86 ~amd64-linux ~x86-linux ~ppc-macos"
 IUSE="ssl"
 
 RDEPEND="net-libs/libpcap
@@ -26,7 +26,8 @@ src_prepare() {
 	epatch "${FILESDIR}"/${P}-libpcap-header.patch \
 		"${FILESDIR}"/${P}-configure-dylib.patch \
 		"${FILESDIR}"/${P}-openssl-0.9.8.compile-fix.patch \
-		"${FILESDIR}"/${P}-DLT_LINUX_SLL.patch
+		"${FILESDIR}"/${P}-DLT_LINUX_SLL.patch \
+		"${FILESDIR}"/${P}-makefile-fix.patch
 
 	sed -i configure.in -e 's|libpcap.a|libpcap.so|g' || die
 
@@ -35,8 +36,18 @@ src_prepare() {
 
 src_configure() {
 	local myconf
-	use ssl || myconf="--without-openssl"
-
+	myconf="${myconf} \
+		--with-pcap-inc=${EPREFIX}/usr/include \
+		--with-pcap-lib=${EPREFIX}/usr/$(get_libdir)"
+
+	if use ssl; then
+		myconf="${myconf} \
+			--with-openssl-inc=${EPREFIX}/usr/include \
+			--with-openssl-lib=${EPREFIX}/usr/$(get_libdir)"
+	else
+		myconf="${myconf} --without-openssl"
+	fi
+	
 	econf ${myconf}
 }
 
