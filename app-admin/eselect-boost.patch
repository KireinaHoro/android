diff -Naurp eselect-boost.old/eselect-boost-0.4.ebuild eselect-boost/eselect-boost-0.4.ebuild
--- eselect-boost.old/eselect-boost-0.4.ebuild	2012-05-17 01:01:01.000000000 +0900
+++ eselect-boost/eselect-boost-0.4.ebuild	2012-05-21 19:44:03.300079056 +0900
@@ -2,6 +2,8 @@
 # Distributed under the terms of the GNU General Public License v2
 # $Header: /var/cvsroot/gentoo-x86/app-admin/eselect-boost/eselect-boost-0.4.ebuild,v 1.6 2012/05/16 15:38:05 jer Exp $
 
+EAPI="4"
+
 inherit multilib
 
 DESCRIPTION="boost module for eselect"
@@ -10,16 +12,17 @@ SRC_URI=""
 
 LICENSE="GPL-2"
 SLOT="0"
-KEYWORDS="~alpha amd64 arm hppa ~ia64 ~mips ppc ~ppc64 ~s390 ~sh ~sparc ~x86 ~amd64-fbsd ~x86-fbsd"
+KEYWORDS="~alpha amd64 arm hppa ~ia64 ~mips ppc ~ppc64 ~s390 ~sh ~sparc ~x86 ~ppc-aix ~amd64-fbsd ~x86-fbsd ~ia64-hpux ~amd64-linux ~x86-linux ~ppc-macos ~x64-macos ~x86-macos ~sparc-solaris ~sparc64-solaris ~x86-solaris"
 IUSE=""
 
 DEPEND=""
 RDEPEND=">=app-admin/eselect-1.0.5"
+S="${WORKDIR}"
 
 src_install() {
 	local mdir="/usr/share/eselect/modules"
 	dodir ${mdir}
-	sed -e "s|%LIBDIR%|$(get_libdir)|g" "${FILESDIR}/boost.eselect-${PVR}" > "${D}${mdir}/boost.eselect" || die "failed to install"
+	sed -e "s|%LIBDIR%|$(get_libdir)|g" "${FILESDIR}/boost.eselect-${PVR}" > "${ED}${mdir}/boost.eselect" || die "failed to install"
 
 	keepdir /etc/eselect/boost
 	keepdir /usr/share/boost-eselect/profiles
diff -Naurp eselect-boost.old/files/boost.eselect-0.4 eselect-boost/files/boost.eselect-0.4
--- eselect-boost.old/files/boost.eselect-0.4	2012-04-02 09:51:03.000000000 +0900
+++ eselect-boost/files/boost.eselect-0.4	2012-05-21 19:39:12.337065431 +0900
@@ -17,7 +17,7 @@ _suffices="|-debug"
 find_targets() {
 	local f
 	# use ls here to get a really empty set in case no boost is installed
-	for d in $(ls -d "${ROOT}"/usr/share/boost-eselect/profiles/* 2>/dev/null) ; do
+	for d in $(ls -d "${EROOT}"/usr/share/boost-eselect/profiles/* 2>/dev/null) ; do
 		for p in "${d}"/* ; do
 			echo "boost-$(basename ${d})/$(basename ${p})"
 		done
@@ -28,7 +28,7 @@ remove_installation() {
 	echo "Removing symlinks from old version"
 
 	local link
-	for link in "${ROOT}/usr/include/boost" "${ROOT}/usr/share/boostbook" ; do
+	for link in "${EROOT}/usr/include/boost" "${EROOT}/usr/share/boostbook" ; do
 		if [[ -L "${link}" ]] ; then
 			rm "${link}" || die -q "Couldn't remove \"${link}\" symlink"
 		else
@@ -36,15 +36,15 @@ remove_installation() {
 		fi
 	done
 
-	pushd "${ROOT}/usr/%LIBDIR%" 1>/dev/null
+	pushd "${EROOT}/usr/%LIBDIR%" 1>/dev/null
 	local lib
-	for lib in libboost_*.{a,so} ; do
-		[[ -L "${lib}" && "${lib}" != libboost_*[[:digit:]]_[[:digit:]][[:digit:]]@(${_suffices}).@(a|so) ]] || continue
+	for lib in libboost_*.{a,so,dylib} ; do
+		[[ -L "${lib}" && "${lib}" != libboost_*[[:digit:]]_[[:digit:]][[:digit:]]@(${_suffices}).@(a|so|dylib) ]] || continue
 		rm "${lib}" || die -q "Unable to remove \"/usr/%LIBDIR%/${lib}\" symlink"
 	done
 	popd 1>/dev/null
 
-	pushd "${ROOT}"/usr/bin 1>/dev/null
+	pushd "${EROOT}"/usr/bin 1>/dev/null
 	local tool
 	for tool in ${_boost_tools} ; do
 		[[ -L "${tool}" ]] && ( rm "${tool}" || die -q "Unable to remove \"/usr/bin/${tool}\" symlink" )
@@ -53,7 +53,7 @@ remove_installation() {
 
 	local python_module python_module_dir
 	for python_module in mpi.py mpi_debug.py ; do
-		for python_module_dir in "${ROOT}"usr/%LIBDIR%/python*/site-packages ; do
+		for python_module_dir in "${EROOT}"usr/%LIBDIR%/python*/site-packages ; do
 			if [[ -e "${python_module_dir}/${python_module}" ]] ; then
 				rm "${python_module_dir}/${python_module}" || die -q "Unable to remove \"${python_module_dir}/${python_module}\""
 			fi
@@ -62,7 +62,7 @@ remove_installation() {
 
 	# Deprecated code for older versions of Boost.
 	local mod="mpi.so"
-	for moddir in "${ROOT}"/usr/%LIBDIR%/python*/site-packages ; do
+	for moddir in "${EROOT}"/usr/%LIBDIR%/python*/site-packages ; do
 		if [ -L "${moddir}/${mod}" ] ; then
 			rm "${moddir}/${mod}" || die -q "Unable to remove \"${moddir}/${mod}\" symlink"
 		else
@@ -77,10 +77,10 @@ remove_installation() {
 		echo "from ${target_python_module} import *" > "${ROOT}${wrapper_python_module}" || die -q "Couldn't create wrapper python module \"$(pwd)/${wrapper_python_module}\""
 	done
 
-	if [ -L "${ROOT}/etc/eselect/boost/active" ] ; then
-		rm  "${ROOT}/etc/eselect/boost/active" || die -q "Unable to remove \"${ROOT}/etc/eselect/boost/active\" symlink"
+	if [ -L "${EROOT}/etc/eselect/boost/active" ] ; then
+		rm  "${EROOT}/etc/eselect/boost/active" || die -q "Unable to remove \"${EROOT}/etc/eselect/boost/active\" symlink"
 	else
-		[[ -e "${ROOT}/etc/eselect/boost/active" ]] && die -q "\"${ROOT}/etc/eselect/boost/active\" exists and isn't a symlink"
+		[[ -e "${EROOT}/etc/eselect/boost/active" ]] && die -q "\"${EROOT}/etc/eselect/boost/active\" exists and isn't a symlink"
 	fi
 }
 
@@ -95,10 +95,10 @@ set_installation() {
 	version="${version/boost-}"
 	version="${version/./_}"
 
-	cd "${ROOT}/etc/eselect/boost"
-	ln -s "${ROOT}/usr/share/boost-eselect/profiles/${target//boost-}" active || die -q "Couldn't create symlink active -> /usr/share/boost-eselect/profiles/${target//boost-}/${profile}"
+	cd "${EROOT}/etc/eselect/boost"
+	ln -s "${EROOT}/usr/share/boost-eselect/profiles/${target//boost-}" active || die -q "Couldn't create symlink active -> /usr/share/boost-eselect/profiles/${target//boost-}/${profile}"
 
-	. "${ROOT}/usr/share/boost-eselect/profiles/${target//boost-}"
+	. "${EROOT}/usr/share/boost-eselect/profiles/${target//boost-}"
 
 	for t in ${dirs} ${bins} ${libs} ; do
 		[[ -e "${ROOT}${t}" ]] || die -q "\"${t}\" listed as target does not exist"
@@ -112,7 +112,7 @@ set_installation() {
 	done
 
 	[[ -d "${ROOT}${includes}" ]] || die -q "\"${includes}\" does not exist"
-	pushd "${ROOT}/usr/include" 1>/dev/null
+	pushd "${EROOT}/usr/include" 1>/dev/null
 	ln -s ${includes//\/usr\/include\/} boost || die -q "Couldn't create symlink \"/usr/include/boost\""
 	popd 1>/dev/null
 
@@ -144,8 +144,8 @@ do_show() {
 	local include
 
 	write_list_start "Current boost version:"
-	if [[ -L "${ROOT}"/usr/include/boost ]] ; then
-		include=$(basename $(dirname $(canonicalise "${ROOT}"/usr/include/boost )))
+	if [[ -L "${EROOT}"/usr/include/boost ]] ; then
+		include=$(basename $(dirname $(canonicalise "${EROOT}"/usr/include/boost )))
 		write_kv_list_entry "${include%/}" ""
 	else
 		write_kv_list_entry "(unset)" ""
@@ -163,8 +163,8 @@ do_list() {
 	write_list_start "Available boost versions:"
 	if [[ -n "${targets[@]}" ]] ; then
 		local i
-		local active_slot=$(canonicalise "${ROOT}/etc/eselect/boost/active")
-		active_slot=${active_slot/"${ROOT}/usr/share/boost-eselect/profiles/"/boost-}
+		local active_slot=$(canonicalise "${EROOT}/etc/eselect/boost/active")
+		active_slot=${active_slot/"${EROOT}/usr/share/boost-eselect/profiles/"/boost-}
 		for (( i = 0 ; i < ${#targets[@]} ; i = i + 1 )) ; do
 			if [[ "${targets[${i}]}" == ${active_slot} ]] ; then
 				targets[${i}]="${targets[${i}]} $(highlight '*' )"
@@ -217,8 +217,8 @@ do_update() {
 	profile="default"
 
 	# extract profile if there's already one boost version selected
-	if [ -L "${ROOT}"/etc/eselect/boost/active ] ; then
-		profile=$(basename $(canonicalise "${ROOT}/etc/eselect/boost/active"))
+	if [ -L "${EROOT}"/etc/eselect/boost/active ] ; then
+		profile=$(basename $(canonicalise "${EROOT}/etc/eselect/boost/active"))
 	fi
 
 	echo "Previously selected profile: ${profile}"
